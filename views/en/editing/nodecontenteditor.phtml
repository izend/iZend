<?php

/**
 *
 * @copyright  2010-2011 izend.org
 * @version    2
 * @link       http://www.izend.org
 */
?>
<?php extract($errors); ?>
<form action="" method="post">
<input name="clang" type="hidden" value="<?php echo $clang; ?>" />
<p>
<input name="content_create" type="submit" value="Add" />
a type
<?php
$selected=$new_content_type ? $new_content_type : 'text';
?>
<select name="content_new_type" size="1">
<option value="text" <?php echo $selected == 'text' ? 'selected="selected"' : ''; ?>>Text</option>
<option value="file" <?php echo $selected == 'file' ? 'selected="selected"' : ''; ?>>File</option>
<option value="download" <?php echo $selected == 'download' ? 'selected="selected"' : ''; ?>>Download</option>
<option value="infile" <?php echo $selected == 'infile' ? 'selected="selected"' : ''; ?>>Insert</option>
<option value="media" <?php echo $selected == 'media' ? 'selected="selected"' : ''; ?>>Media</option>
</select>
#
<input name="content_new_number" type="text" size="2" maxlength="2" value="<?php echo htmlspecialchars($new_content_number, ENT_COMPAT, 'UTF-8'); ?>" title="Number"/>
<?php if ($node_contents): ?>
or
<input name="content_delete" type="submit" value="Delete" />
#
<input name="content_old_number" type="text" size="2" maxlength="2" value="<?php echo htmlspecialchars($old_content_number, ENT_COMPAT, 'UTF-8'); ?>" title="Number"/>
<?php endif; ?>
</p>
<?php if ($missing_new_content_type or $bad_new_content_type or $bad_new_content_number or $missing_old_content_number or $bad_old_content_number or $missing_content_number or $bad_content_number): ?>
<div class="alert">
<?php if ($missing_new_content_type): ?>
<p>The new content has no type.</p>
<?php elseif ($bad_new_content_type): ?>
<p>The type of the new content is not valid.</p>
<?php endif; ?>
<?php if ($bad_new_content_number): ?>
<p>The new content number is not valid.</p>
<?php endif; ?>
<?php if ($missing_old_content_number): ?>
<p>You didn't specify the number of the content to delete.</p>
<?php elseif ($bad_old_content_number): ?>
<p>The number of the content to delete is not valid.</p>
<?php endif; ?>
<?php if ($missing_content_number): ?>
<p>A content number is missing.</p>
<?php endif; ?>
<?php if ($bad_content_number): ?>
<p>A content number is not valid.</p>
<?php endif; ?>
</div>
<?php endif; ?>
<?php if ($node_contents): ?>
<?php
$i=1;
foreach ($node_contents as $c) {
	$content_ignored=false;
	$content_text='';
	$content_eval=false;
	$content_file=$content_format=$content_lineno=false;
	$content_start=$content_end=0;
	$content_download=$content_path=false;
	$content_infile=false;
	$content_media_file=$content_media_image=false;
	$content_media_width=$content_media_height=0;
	$content_media_skin=false;
	$content_media_icons=false;
	$content_media_duration=0;
	$content_media_autostart=$content_media_repeat=false;
	extract($c);	/* content_id content_number content_ignored content_type (content_text | content_file content_start content_end content_format content_lineno | content_download content_path | content_infile |content_media_file content_media_image content_media_width content_media_height content_media_skin content_media_icons content_media_duration content_media_autostart content_media_repeat) content_pos */
?>
<p class="<?php echo $content_ignored ? 'ignored' : (($i % 2) ? 'odd' : 'even'); ?>">
<?php echo $i; ?>.
<input name="content_id[<?php echo $i; ?>]" type="hidden" value="<?php echo $content_id; ?>"/>
<input name="content_p[<?php echo $i; ?>]" type="text" size="2" maxlength="2" value="<?php echo htmlspecialchars($content_pos, ENT_COMPAT, 'UTF-8'); ?>"/>
<input name="content_ignored[<?php echo $i; ?>]" type="checkbox" <?php if ($content_ignored) echo 'checked="checked"'; ?> /><img src="<?php echo $base_path; ?>/images/theme/edit/cross.png" alt="ignore" title="Ignored" />
<?php switch ($content_type): ?>
<?php case 'text': ?>
<label>Text:</label>
<?php break; ?>
<?php case 'file': ?>
<label>File:</label>
<?php break; ?>
<?php case 'download': ?>
<label>Download:</label>
<?php break; ?>
<?php case 'infile': ?>
<label>Insert:</label>
<?php break; ?>
<?php case 'media': ?>
<label>Media:</label>
<?php break; ?>
<?php endswitch; ?>
</p>
<?php switch ($content_type): ?>
<?php case 'text': ?>
<div class="tagbar">
<img src="<?php echo $base_path; ?>/images/theme/edit/p.png" alt="&lt;p&gt;" title="p" onclick="addtag('content_text_<?php echo $i; ?>', '&lt;p&gt;','&lt;/p&gt;')"/>
<img src="<?php echo $base_path; ?>/images/theme/edit/b.png" alt="&lt;b&gt;" title="b" onclick="addtag('content_text_<?php echo $i; ?>', '&lt;b&gt;','&lt;/b&gt;')"/>
<img src="<?php echo $base_path; ?>/images/theme/edit/i.png" alt="&lt;i&gt;" title="i" onclick="addtag('content_text_<?php echo $i; ?>', '&lt;i&gt;','&lt;/i&gt;')"/>
<img src="<?php echo $base_path; ?>/images/theme/edit/u.png" alt="&lt;u&gt;" title="u" onclick="addtag('content_text_<?php echo $i; ?>', '&lt;u&gt;','&lt;/u&gt;')"/>
<img src="<?php echo $base_path; ?>/images/theme/edit/s.png" alt="&lt;s&gt;" title="s" onclick="addtag('content_text_<?php echo $i; ?>', '&lt;s&gt;','&lt;/s&gt;')"/>
<img src="<?php echo $base_path; ?>/images/theme/edit/h4.png" alt="&lt;h4&gt;" title="h4" onclick="addtag('content_text_<?php echo $i; ?>', '&lt;h4&gt;','&lt;/h4&gt;')"/>
<img src="<?php echo $base_path; ?>/images/theme/edit/h5.png" alt="&lt;h5&gt;" title="h5" onclick="addtag('content_text_<?php echo $i; ?>', '&lt;h5&gt;','&lt;/h5&gt;')"/>
<img src="<?php echo $base_path; ?>/images/theme/edit/h6.png" alt="&lt;h6&gt;" title="h6" onclick="addtag('content_text_<?php echo $i; ?>', '&lt;h6&gt;','&lt;/h6&gt;')"/>
<img src="<?php echo $base_path; ?>/images/theme/edit/fixed.png" alt="&lt;code&gt;" title="code" onclick="addtag('content_text_<?php echo $i; ?>', '&lt;code&gt;','&lt;/code&gt;')"/>
<img src="<?php echo $base_path; ?>/images/theme/edit/shell.png" alt="&lt;pre&gt;&lt;code&gt;" title="pre code" onclick="addtag('content_text_<?php echo $i; ?>', '&lt;pre&gt;&lt;code&gt;','&lt;/code&gt;&lt;/pre&gt;')"/>
<img src="<?php echo $base_path; ?>/images/theme/edit/quote.png" alt="&lt;blockquote&gt;" title="blockquote" onclick="addtag('content_text_<?php echo $i; ?>', '&lt;blockquote&gt;','&lt;/blockquote&gt;')"/>
<img src="<?php echo $base_path; ?>/images/theme/edit/img.png" alt="&lt;img&gt;" title="img" onclick="addtag('content_text_<?php echo $i; ?>', '&lt;img src=\x22','\x22 alt=\x22\x22 /&gt;')"/>
<img src="<?php echo $base_path; ?>/images/theme/edit/url.png" alt="&lt;a&gt;" title="a" onclick="addtag('content_text_<?php echo $i; ?>', '&lt;a href=\x22','\x22&gt;&lt;/a&gt;')"/>
<img src="<?php echo $base_path; ?>/images/theme/edit/entquote.png" alt="entquote" title="entquote" onclick="entquote('content_text_<?php echo $i; ?>')"/>
<span><input name="content_eval[<?php echo $i; ?>]" type="checkbox" <?php if ($content_eval) echo 'checked="checked"'; ?> /><img src="<?php echo $base_path; ?>/images/theme/edit/code.png" alt="PHP" title="seval" /></span>
</div>
<textarea id="content_text_<?php echo $i; ?>" name="content_text[<?php echo $i; ?>]" cols="100" rows="8"><?php echo htmlspecialchars($content_text, ENT_COMPAT, 'UTF-8'); ?></textarea>
<br/><img class="grippie" src="<?php echo $base_path; ?>/images/theme/edit/grippie.png" alt="===" />
<?php break; ?>
<?php case 'file': ?>
<p>
<input name="content_file[<?php echo $i; ?>]" type="text" size="40" maxlength="200" value="<?php echo htmlspecialchars($content_file, ENT_COMPAT, 'UTF-8'); ?>" title="File" />
<input name="content_start[<?php echo $i; ?>]" type="text" size="5" maxlength="5" value="<?php echo htmlspecialchars($content_start, ENT_COMPAT, 'UTF-8'); ?>" title="Start" />
<input name="content_end[<?php echo $i; ?>]" type="text" size="5" maxlength="5" value="<?php echo htmlspecialchars($content_end, ENT_COMPAT, 'UTF-8'); ?>" title="End" />
<input name="content_format[<?php echo $i; ?>]" type="text" size="10" maxlength="20" value="<?php echo htmlspecialchars($content_format, ENT_COMPAT, 'UTF-8'); ?>" title="Format" />
<input name="content_lineno[<?php echo $i; ?>]" type="checkbox" <?php if ($content_lineno) echo 'checked="checked"'; ?> /><img src="<?php echo $base_path; ?>/images/theme/edit/ol.png" alt="number" title="Number" />
</p>
<?php break; ?>
<?php case 'download': ?>
<p>
<input name="content_download[<?php echo $i; ?>]" type="text" size="20" maxlength="50" value="<?php echo htmlspecialchars($content_download, ENT_COMPAT, 'UTF-8'); ?>" title="Name" />
<input name="content_path[<?php echo $i; ?>]" type="text" size="40" maxlength="200" value="<?php echo htmlspecialchars($content_path, ENT_COMPAT, 'UTF-8'); ?>" title="File" />
</p>
<?php break; ?>
<?php case 'infile': ?>
<p>
<input name="content_infile[<?php echo $i; ?>]" type="text" size="40" maxlength="200" value="<?php echo htmlspecialchars($content_infile, ENT_COMPAT, 'UTF-8'); ?>" title="File" />
</p>
<?php break; ?>
<?php case 'media': ?>
<p>
<input name="content_media_file[<?php echo $i; ?>]" type="text" size="40" maxlength="200" value="<?php echo htmlspecialchars($content_media_file, ENT_COMPAT, 'UTF-8'); ?>" title="File" />
<input name="content_media_width[<?php echo $i; ?>]" type="text" size="5" maxlength="5" value="<?php echo htmlspecialchars($content_media_width, ENT_COMPAT, 'UTF-8'); ?>" title="Width" />
x
<input name="content_media_height[<?php echo $i; ?>]" type="text" size="5" maxlength="5" value="<?php echo htmlspecialchars($content_media_height, ENT_COMPAT, 'UTF-8'); ?>" title="Height" />
<img src="<?php echo $base_path; ?>/images/theme/edit/time.png" alt="Duration: " />
<input name="content_media_duration[<?php echo $i; ?>]" type="text" size="5" maxlength="5" value="<?php echo htmlspecialchars($content_media_duration, ENT_COMPAT, 'UTF-8'); ?>" title="Duration" />
<input name="content_media_autostart[<?php echo $i; ?>]" type="checkbox" <?php if ($content_media_autostart) echo 'checked="checked"'; ?> /><img src="<?php echo $base_path; ?>/images/theme/edit/play.png" alt="auto" title="Auto" /><input name="content_media_repeat[<?php echo $i; ?>]" type="checkbox" <?php if ($content_media_repeat) echo 'checked="checked"'; ?> /><img src="<?php echo $base_path; ?>/images/theme/edit/repeat.png" alt="loop" title="Loop" />
</p>
<p>
<input name="content_media_image[<?php echo $i; ?>]" type="text" size="40" maxlength="200" value="<?php echo htmlspecialchars($content_media_image, ENT_COMPAT, 'UTF-8'); ?>" title="Picture" />
<input name="content_media_icons[<?php echo $i; ?>]" type="checkbox" <?php if ($content_media_icons) echo 'checked="checked"'; ?> /><img src="<?php echo $base_path; ?>/images/theme/edit/imgplay.png" alt="icons" title="Icons" />
</p>
<p>
<input name="content_media_skin[<?php echo $i; ?>]" type="text" size="40" maxlength="200" value="<?php echo htmlspecialchars($content_media_skin, ENT_COMPAT, 'UTF-8'); ?>" title="Skin" />
</p>
<?php break; ?>
<?php endswitch; ?>
<?php
	$i++;
}
?>
<p>
<input id="content_modify" name="content_modify" type="submit" value="Modify" />
contents
</p>
<?php endif; ?>
</form>
<script type="text/javascript">
<!--
$(document).ready(function() {
	$('.grippie').each(function() {
		var grippie = $(this);
		var textarea = grippie.prev().prev();
		var offset;

		grippie.mousedown(startDrag);

	    function startDrag(e) {
	      offset = textarea.height() - e.pageY;
	      textarea.css('opacity', 0.25);
	      $(document).mousemove(performDrag).mouseup(endDrag);
	      return false;
	    }

	    function performDrag(e) {
	      textarea.height(Math.max(32, offset + e.pageY) + 'px');
	      return false;
	    }

	    function endDrag(e) {
	      $(document).unbind('mousemove', performDrag).unbind('mouseup', endDrag);
	      textarea.css('opacity', 1);
	    }
	});
});
//-->
</script>
